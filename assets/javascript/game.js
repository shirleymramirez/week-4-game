$(document).ready(function() {

	// Global Variable setup
	var redCrystalValue;
	var blueCrystalValue;
	var yellowCrystalValue;
	var greenCrystalValue;
	var wins = 0;
	var losses = 0;

	// Random Number Generated by Computer
	var randNum;

	// userTallyScore is the ongoing sum of crystal values user has picked
	var userTallyScore;

	// Function SetUp

	// Function Initialization for each game round
	function initVariables() {
		// Randomized number picked by the computer
		randNum = 19 + Math.floor(Math.random() * 102);

		// pick random crystal values between 1-12
		redCrystalValue = 1 + Math.floor(Math.random() * 12);
		blueCrystalValue = 1 + Math.floor(Math.random() * 12);
		yellowCrystalValue = 1 + Math.floor(Math.random() * 12);
		greenCrystalValue = 1 + Math.floor(Math.random() * 12);

		// Set initial value of user's ongoing crystal selections sum to 0
		userTallyScore = 0;

		// Update html for the game board
		$(".winScore").html("Wins: " + wins);
		$(".losesScore").html("Loses: " + losses);
		$("#numGenerator").html(randNum);
		$("#userScore").html(userTallyScore);
	}

	// function to check if user has won or lost
	// increment wins / losses in either case
	// and then re-initialize variables for new round
	// if user hasn't won or lost then nothing happens
	function winLoseCheck() {
		// check if user has lost
		if (userTallyScore > randNum) {
			losses++;
			$("#losesScore").html("Loses: " + losses);
			initVariables();
		}

		// check if user has won
		if (userTallyScore == randNum) {
			wins++;
			$("#winScore").html("Wins: " + wins);
			initVariables();
		}
	}

	// =====================================
	// Now comes the main game functionality
	// =====================================

	initVariables();

	// listen for clicks on any of the crystal by targeting the crystal
	$(".crystal").on("click", function() {
		// each crsytal has a value attribute of redcrystal, bluecyrstal, yellowcyrstal, or greencyrstal
		// use this attribute to identify which crystal the user actually clicked
		var pressedKey = $(this).attr("value");
        
        // add the value of the crystal to the user's ongoing score tally
        if (pressedKey == "redcyrstal") {
        	userTallyScore += redCrystalValue;
        } else if (pressedKey == "bluecyrstal") {
        	userTallyScore += blueCrystalValue;
        } else if (pressedKey == "yellowcyrstal") {
        	userTallyScore += yellowCrystalValue;
        } else if (pressedKey == "greencyrstal") {
        	userTallyScore += greenCrystalValue;
        } else {
        	console.log("error");
        }
        // then update the html for the user score
        $("#userScore").html(userTallyScore);
        // call the function to see if user has won or lost
        winLoseCheck();
	});

});